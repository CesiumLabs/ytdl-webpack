!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["youtube-sr"]=t():e["youtube-sr"]=t()}(global,(function(){return(()=>{"use strict";var e={634:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){if(!e)throw new Error("Cannot instantiate the "+this.constructor.name+" class without data!");this._patch(e)}return e.prototype._patch=function(e){e||(e={}),this.name=e.name||null,this.verified=!!e.verified||!1,this.id=e.id||null,this.url=e.url||null,this.icon=e.icon||{url:null,width:0,height:0},this.subscribers=e.subscribers||null},e.prototype.iconURL=function(e){if(void 0===e&&(e={size:0}),"number"!=typeof e.size||e.size<0)throw new Error("invalid icon size");if(!this.icon.url)return null;var t=this.icon.url.split("=s")[1].split("-c")[0];return this.icon.url.replace("=s"+t+"-c","=s"+e.size+"-c")},Object.defineProperty(e.prototype,"type",{get:function(){return"channel"},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.name||""},e.prototype.toJSON=function(){return{name:this.name,verified:this.verified,id:this.id,url:this.url,iconURL:this.iconURL(),type:this.type,subscribers:this.subscribers}},e}();t.default=n},354:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function l(e){try{a(r.next(e))}catch(e){o(e)}}function s(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,s)}a((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,r=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(i=(i=l.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){l.label=o[1];break}if(6===o[0]&&l.label<i[1]){l.label=i[1],i=o;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(o);break}i[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)l.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return l},l=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=a(n(892)),d=function(){function e(e,t){if(void 0===e&&(e={}),void 0===t&&(t=!1),this._continuation={},!e)throw new Error("Cannot instantiate the "+this.constructor.name+" class without data!");t?this._patchSearch(e):this._patch(e)}return e.prototype._patch=function(e){var t,n,r,i,o,l;this.id=e.id||null,this.title=e.title||null,this.videoCount=e.videoCount||0,this.lastUpdate=e.lastUpdate||null,this.views=e.views||0,this.url=e.url||null,this.link=e.link||null,this.channel=e.author||null,this.thumbnail=e.thumbnail||null,this.videos=e.videos||[],this._continuation.api=null!==(n=null===(t=e.continuation)||void 0===t?void 0:t.api)&&void 0!==n?n:null,this._continuation.token=null!==(i=null===(r=e.continuation)||void 0===r?void 0:r.token)&&void 0!==i?i:null,this._continuation.clientVersion=null!==(l=null===(o=e.continuation)||void 0===o?void 0:o.clientVersion)&&void 0!==l?l:"<important data>"},e.prototype._patchSearch=function(e){this.id=e.id||null,this.title=e.title||null,this.thumbnail=e.thumbnail||null,this.channel=e.channel||null,this.videos=[],this.videoCount=e.videos||0,this.url=this.id?"https://www.youtube.com/playlist?list="+this.id:null,this.link=null,this.lastUpdate=null,this.views=0},e.prototype.next=function(e){var t,n,s;return void 0===e&&(e=1/0),r(this,void 0,void 0,(function(){var r,a,d;return i(this,(function(i){switch(i.label){case 0:return this._continuation&&this._continuation.token?[4,u.default.getHTML("https://www.youtube.com/youtubei/v1/browse?key="+this._continuation.api,{method:"POST",body:JSON.stringify({continuation:this._continuation.token,context:{client:{utcOffsetMinutes:0,gl:"US",hl:"en",clientName:"WEB",clientVersion:this._continuation.clientVersion},user:{},request:{}}})})]:[2,[]];case 1:return r=i.sent(),(a=null===(s=null===(n=null===(t=u.default.json(r))||void 0===t?void 0:t.onResponseReceivedActions[0])||void 0===n?void 0:n.appendContinuationItemsAction)||void 0===s?void 0:s.continuationItems)?(d=u.default.getPlaylistVideos(a,e),this._continuation.token=u.default.getContinuationToken(a),this.videos=l(l([],o(this.videos)),o(d)),[2,d]):[2,[]]}}))}))},e.prototype.fetch=function(e){return void 0===e&&(e=1/0),r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:if(!this._continuation.token)return[2,this];e<1&&(e=1/0),t.label=1;case 1:return"string"==typeof this._continuation.token&&this._continuation.token.length?this.videos.length>=e?[3,3]:[4,this.next()]:[3,3];case 2:return t.sent().length?[3,1]:[3,3];case 3:return[2,this]}}))}))},Object.defineProperty(e.prototype,"type",{get:function(){return"playlist"},enumerable:!1,configurable:!0}),e.prototype[Symbol.iterator]=function(){return i(this,(function(e){switch(e.label){case 0:return[5,s(this.videos)];case 1:return e.sent(),[2]}}))},e.prototype.toJSON=function(){return{id:this.id,title:this.title,thumbnail:this.thumbnail.toJSON(),channel:{name:this.channel.name,id:this.channel.id,icon:this.channel.iconURL()},url:this.url,videos:this.videos}},e}();t.default=d},654:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){if(!e)throw new Error("Cannot instantiate the "+this.constructor.name+" class without data!");this._patch(e)}return e.prototype._patch=function(e){e||(e={}),this.id=e.id||null,this.width=e.width||0,this.height=e.height||0,this.url=e.url||null},e.prototype.displayThumbnailURL=function(e){if(void 0===e&&(e="ultrares"),!["default","hqdefault","mqdefault","sddefault","maxresdefault","ultrares"].includes(e))throw new Error('Invalid thumbnail type "'+e+'"!');return"ultrares"===e?this.url:"https://i3.ytimg.com/vi/"+this.id+"/"+e+".jpg"},e.prototype.defaultThumbnailURL=function(e){if(e||(e="0"),!["0","1","2","3","4"].includes(e))throw new Error('Invalid thumbnail id "'+e+'"!');return"https://i3.ytimg.com/vi/"+this.id+"/"+e+".jpg"},e.prototype.toString=function(){return this.url?""+this.url:""},e.prototype.toJSON=function(){return{id:this.id,width:this.width,height:this.height,url:this.url}},e}();t.default=n},597:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(634)),o=r(n(654)),l=function(){function e(e){if(!e)throw new Error("Cannot instantiate the "+this.constructor.name+" class without data!");this._patch(e)}return e.prototype._patch=function(e){var t,n;e||(e={}),this.id=e.id||null,this.title=e.title||null,this.description=e.description||null,this.durationFormatted=e.duration_raw||"0:00",this.duration=(e.duration<0?0:e.duration)||0,this.uploadedAt=e.uploadedAt||null,this.views=parseInt(e.views)||0,this.thumbnail=new o.default(e.thumbnail||{}),this.channel=new i.default(e.channel||{}),this.likes=(null===(t=e.ratings)||void 0===t?void 0:t.likes)||0,this.dislikes=(null===(n=e.ratings)||void 0===n?void 0:n.dislikes)||0,this.live=!!e.live,this.private=!!e.private,this.tags=e.tags||[],e.videos&&(this.videos=e.videos)},Object.defineProperty(e.prototype,"url",{get:function(){return this.id?"https://www.youtube.com/watch?v="+this.id:null},enumerable:!1,configurable:!0}),e.prototype.embedHTML=function(e){return void 0===e&&(e={id:"ytplayer",width:640,height:360}),this.id?'<iframe title="__youtube_sr_frame__" id="'+(e.id||"ytplayer")+'" type="text/html" width="'+(e.width||640)+'" height="'+(e.height||360)+'" src="'+this.embedURL+'" frameborder="0"></iframe>':null},Object.defineProperty(e.prototype,"embedURL",{get:function(){return this.id?"https://www.youtube.com/embed/"+this.id:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return"video"},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.url||""},e.prototype.toJSON=function(){return{id:this.id,url:this.url,title:this.title,description:this.description,duration:this.duration,duration_formatted:this.durationFormatted,uploadedAt:this.uploadedAt,thumbnail:this.thumbnail.toJSON(),channel:{name:this.channel.name,id:this.channel.id,icon:this.channel.iconURL()},views:this.views,type:this.type,tags:this.tags,ratings:{likes:this.likes,dislikes:this.dislikes},live:this.live,private:this.private}},e}();t.default=l},892:function(e,t,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(n(634)),s=o(n(354)),a=o(n(597)),u=/^https?:\/\/(www.)?youtube.com\/playlist\?list=((PL|UU|LL|RD|OL)[a-zA-Z0-9-_]{16,41})$/,d=/(PL|UU|LL|RD|OL)[a-zA-Z0-9-_]{16,41}/,c=/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube\.com|youtu.be))(\/(?:[\w\-]+\?v=|embed\/|v\/)?)([\w\-]+)(\S+)?$/,h=/^[a-zA-Z0-9-_]{11}$/,p="undefined"!=typeof window?window.fetch:n(85),f=function(){function e(){throw new Error("The "+this.constructor.name+" class may not be instantiated!")}return Object.defineProperty(e,"VideoRegex",{get:function(){return c},enumerable:!1,configurable:!0}),Object.defineProperty(e,"VideoIDRegex",{get:function(){return h},enumerable:!1,configurable:!0}),Object.defineProperty(e,"PlaylistURLRegex",{get:function(){return u},enumerable:!1,configurable:!0}),Object.defineProperty(e,"PlaylistIDRegex",{get:function(){return d},enumerable:!1,configurable:!0}),e.getHTML=function(e,t){return t||(t={headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0"}}),new Promise((function(n,r){p(e,t).then((function(e){if(!e.ok)throw new Error("Rejected with status code: "+e.status);return e.text()})).then((function(e){return n(e)})).catch((function(e){return r(e)}))}))},e.parseDuration=function(e){null!=e||(e="0:00");var t=e.split(":"),n=0;switch(t.length){case 3:n=60*parseInt(t[0])*60*1e3+60*parseInt(t[1])*1e3+1e3*parseInt(t[2]);break;case 2:n=60*parseInt(t[0])*1e3+1e3*parseInt(t[1]);break;default:n=1e3*parseInt(t[0])}return n},e.parseSearchResult=function(t,n){if(!t)throw new Error("Invalid raw data");n||(n={type:"video",limit:0}),n.type||(n.type="video");var r=[],i=[],o=!1;try{var l=t.split("ytInitialData = JSON.parse('")[1].split("');<\/script>")[0];t=l.replace(/\\x([0-9A-F]{2})/gi,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return String.fromCharCode(parseInt(e[1],16))}))}catch(e){}try{i=JSON.parse(t.split('{"itemSectionRenderer":{"contents":')[t.split('{"itemSectionRenderer":{"contents":').length-1].split(',"continuations":[{')[0]),o=!0}catch(e){}if(!o)try{i=JSON.parse(t.split('{"itemSectionRenderer":')[t.split('{"itemSectionRenderer":').length-1].split('},{"continuationItemRenderer":{')[0]).contents,o=!0}catch(e){}if(!o)return[];for(var s=0;s<i.length&&!("number"==typeof n.limit&&n.limit>0&&r.length>=n.limit);s++){l=i[s];var a=void 0;if("all"===n.type)if(l.videoRenderer)n.type="video";else if(l.channelRenderer)n.type="channel";else{if(!l.playlistRenderer)continue;n.type="playlist"}if("video"===n.type){if(!(u=e.parseVideo(l)))continue;a=u}else if("channel"===n.type){if(!(u=e.parseChannel(l)))continue;a=u}else if("playlist"===n.type){var u;if(!(u=e.parsePlaylist(l)))continue;a=u}r.push(a)}return r},e.parseChannel=function(e){var t,n;if(e&&e.channelRenderer){var r=e.channelRenderer.ownerBadges&&e.channelRenderer.ownerBadges[0],i="https://www.youtube.com"+(e.channelRenderer.navigationEndpoint.browseEndpoint.canonicalBaseUrl||e.channelRenderer.navigationEndpoint.commandMetadata.webCommandMetadata.url);return new l.default({id:e.channelRenderer.channelId,name:e.channelRenderer.title.simpleText,icon:e.channelRenderer.thumbnail.thumbnails[e.channelRenderer.thumbnail.thumbnails.length-1],url:i,verified:Boolean(null===(n=null===(t=null==r?void 0:r.metadataBadgeRenderer)||void 0===t?void 0:t.style)||void 0===n?void 0:n.toLowerCase().includes("verified")),subscribers:e.channelRenderer.subscriberCountText.simpleText})}},e.parseVideo=function(t){var n,r,i,o,l,s,u;if(t&&t.videoRenderer){var d=t.videoRenderer.ownerBadges&&t.videoRenderer.ownerBadges[0];return new a.default({id:t.videoRenderer.videoId,url:"https://www.youtube.com/watch?v="+t.videoRenderer.videoId,title:t.videoRenderer.title.runs[0].text,description:t.videoRenderer.descriptionSnippet&&t.videoRenderer.descriptionSnippet.runs[0]?t.videoRenderer.descriptionSnippet.runs[0].text:"",duration:t.videoRenderer.lengthText?e.parseDuration(t.videoRenderer.lengthText.simpleText):0,duration_raw:t.videoRenderer.lengthText?t.videoRenderer.lengthText.simpleText:null,thumbnail:{id:t.videoRenderer.videoId,url:t.videoRenderer.thumbnail.thumbnails[t.videoRenderer.thumbnail.thumbnails.length-1].url,height:t.videoRenderer.thumbnail.thumbnails[t.videoRenderer.thumbnail.thumbnails.length-1].height,width:t.videoRenderer.thumbnail.thumbnails[t.videoRenderer.thumbnail.thumbnails.length-1].width},channel:{id:t.videoRenderer.ownerText.runs[0].navigationEndpoint.browseEndpoint.browseId||null,name:t.videoRenderer.ownerText.runs[0].text||null,url:"https://www.youtube.com"+(t.videoRenderer.ownerText.runs[0].navigationEndpoint.browseEndpoint.canonicalBaseUrl||t.videoRenderer.ownerText.runs[0].navigationEndpoint.commandMetadata.webCommandMetadata.url),icon:{url:t.videoRenderer.channelThumbnailSupportedRenderers.channelThumbnailWithLinkRenderer.thumbnail.thumbnails[0].url,width:t.videoRenderer.channelThumbnailSupportedRenderers.channelThumbnailWithLinkRenderer.thumbnail.thumbnails[0].width,height:t.videoRenderer.channelThumbnailSupportedRenderers.channelThumbnailWithLinkRenderer.thumbnail.thumbnails[0].height},verified:Boolean(null===(r=null===(n=null==d?void 0:d.metadataBadgeRenderer)||void 0===n?void 0:n.style)||void 0===r?void 0:r.toLowerCase().includes("verified"))},uploadedAt:null!==(o=null===(i=t.videoRenderer.publishedTimeText)||void 0===i?void 0:i.simpleText)&&void 0!==o?o:null,views:null!==(u=null===(s=null===(l=t.videoRenderer.viewCountText)||void 0===l?void 0:l.simpleText)||void 0===s?void 0:s.replace(/[^0-9]/g,""))&&void 0!==u?u:0})}},e.parsePlaylist=function(e){if(e.playlistRenderer)return new s.default({id:e.playlistRenderer.playlistId,title:e.playlistRenderer.title.simpleText,thumbnail:{id:e.playlistRenderer.playlistId,url:e.playlistRenderer.thumbnails[0].thumbnails[e.playlistRenderer.thumbnails[0].thumbnails.length-1].url,height:e.playlistRenderer.thumbnails[0].thumbnails[e.playlistRenderer.thumbnails[0].thumbnails.length-1].height,width:e.playlistRenderer.thumbnails[0].thumbnails[e.playlistRenderer.thumbnails[0].thumbnails.length-1].width},channel:{id:e.playlistRenderer.shortBylineText.runs[0].navigationEndpoint.browseEndpoint.browseId,name:e.playlistRenderer.shortBylineText.runs[0].text,url:"https://www.youtube.com"+e.playlistRenderer.shortBylineText.runs[0].navigationEndpoint.commandMetadata.webCommandMetadata.url},videos:parseInt(e.playlistRenderer.videoCount.replace(/[^0-9]/g,""))},!0)},e.getPlaylistVideos=function(t,n){var r,i,o,l;void 0===n&&(n=1/0);for(var s=[],u=0;u<t.length&&n!==s.length;u++){var d=t[u].playlistVideoRenderer;d&&d.shortBylineText&&s.push(new a.default({id:d.videoId,index:parseInt(null===(r=d.index)||void 0===r?void 0:r.simpleText)||0,duration:e.parseDuration(null===(i=d.lengthText)||void 0===i?void 0:i.simpleText)||0,duration_raw:null!==(l=null===(o=d.lengthText)||void 0===o?void 0:o.simpleText)&&void 0!==l?l:"0:00",thumbnail:{id:d.videoId,url:d.thumbnail.thumbnails[d.thumbnail.thumbnails.length-1].url,height:d.thumbnail.thumbnails[d.thumbnail.thumbnails.length-1].height,width:d.thumbnail.thumbnails[d.thumbnail.thumbnails.length-1].width},title:d.title.runs[0].text,channel:{id:d.shortBylineText.runs[0].navigationEndpoint.browseEndpoint.browseId||null,name:d.shortBylineText.runs[0].text||null,url:"https://www.youtube.com"+(d.shortBylineText.runs[0].navigationEndpoint.browseEndpoint.canonicalBaseUrl||d.shortBylineText.runs[0].navigationEndpoint.commandMetadata.webCommandMetadata.url),icon:null}}))}return s},e.getPlaylist=function(t,n){var r,i,o,l,a,u,d,c,h,p,f,b,m,y,v;n&&"number"==typeof n||(n=100),n<=0&&(n=1/0);try{var g=t.split('{"playlistVideoListRenderer":{"contents":')[1].split('}],"playlistId"')[0]+"}]";y=JSON.parse(g),v=JSON.parse(t.split('{"playlistSidebarRenderer":')[1].split("}};<\/script>")[0]).items}catch(e){return null}var w=null!==(l=null!==(i=null===(r=t.split('INNERTUBE_API_KEY":"')[1])||void 0===r?void 0:r.split('"')[0])&&void 0!==i?i:null===(o=t.split('innertubeApiKey":"')[1])||void 0===o?void 0:o.split('"')[0])&&void 0!==l?l:"AIzaSyAO_FJ2SlqU8Q4STEHLGCilw_Y9_11qcW8",R=e.getPlaylistVideos(y,n),T=v[0].playlistSidebarPrimaryInfoRenderer;if(!T.title.runs||!T.title.runs.length)return null;var x=null===(a=v[1])||void 0===a?void 0:a.playlistSidebarSecondaryInfoRenderer.videoOwner,S=3===T.stats.length?T.stats[1].simpleText.replace(/[^0-9]/g,""):0,E=null!==(c=null===(d=null===(u=T.stats.find((function(e){return"runs"in e&&e.runs.find((function(e){return e.text.toLowerCase().includes("last update")}))})))||void 0===u?void 0:u.runs.pop())||void 0===d?void 0:d.text)&&void 0!==c?c:null,O=T.stats[0].runs[0].text.replace(/[^0-9]/g,"")||0;return new s.default({continuation:{api:w,token:e.getContinuationToken(y),clientVersion:null!==(b=null!==(p=null===(h=t.split('"INNERTUBE_CONTEXT_CLIENT_VERSION":"')[1])||void 0===h?void 0:h.split('"')[0])&&void 0!==p?p:null===(f=t.split('"innertube_context_client_version":"')[1])||void 0===f?void 0:f.split('"')[0])&&void 0!==b?b:"<some version>"},id:T.title.runs[0].navigationEndpoint.watchEndpoint.playlistId,title:T.title.runs[0].text,videoCount:parseInt(O)||0,lastUpdate:E,views:parseInt(S)||0,videos:R,url:"https://www.youtube.com/playlist?list="+T.title.runs[0].navigationEndpoint.watchEndpoint.playlistId,link:"https://www.youtube.com"+T.title.runs[0].navigationEndpoint.commandMetadata.webCommandMetadata.url,author:x?{name:x.videoOwnerRenderer.title.runs[0].text,id:x.videoOwnerRenderer.title.runs[0].navigationEndpoint.browseEndpoint.browseId,url:"https://www.youtube.com"+(x.videoOwnerRenderer.navigationEndpoint.commandMetadata.webCommandMetadata.url||x.videoOwnerRenderer.navigationEndpoint.browseEndpoint.canonicalBaseUrl),icon:x.videoOwnerRenderer.thumbnail.thumbnails.length?x.videoOwnerRenderer.thumbnail.thumbnails[x.videoOwnerRenderer.thumbnail.thumbnails.length-1].url:null}:{},thumbnail:(null===(m=T.thumbnailRenderer.playlistVideoThumbnailRenderer)||void 0===m?void 0:m.thumbnail.thumbnails.length)?T.thumbnailRenderer.playlistVideoThumbnailRenderer.thumbnail.thumbnails[T.thumbnailRenderer.playlistVideoThumbnailRenderer.thumbnail.thumbnails.length-1].url:null})},e.getContinuationToken=function(e){var t,n,r;return null===(r=null===(n=null===(t=e.find((function(e){return"continuationItemRenderer"===Object.keys(e)[0]})))||void 0===t?void 0:t.continuationItemRenderer.continuationEndpoint)||void 0===n?void 0:n.continuationCommand)||void 0===r?void 0:r.token},e.getVideo=function(t){var n,i,o,l={};try{var s=JSON.parse(t.split("var ytInitialData = ")[1].split(";<\/script>")[0]);o=s.contents.twoColumnWatchNextResults.results.results.contents;try{l=s.contents.twoColumnWatchNextResults.secondaryResults.secondaryResults.results}catch(e){}}catch(e){throw new Error("Could not parse video metadata!")}var u,d={primary:o[0].videoPrimaryInfoRenderer,secondary:o[1].videoSecondaryInfoRenderer};try{u=JSON.parse(t.split("var ytInitialPlayerResponse = ")[1].split(";<\/script>")[0]).videoDetails}catch(e){u=JSON.parse(t.split("var ytInitialPlayerResponse = ")[1].split(";var meta")[0]).videoDetails}return u=r(r(r({},d.primary),d.secondary),{info:u}),new a.default({id:u.info.videoId,title:u.info.title,views:parseInt(u.info.viewCount)||0,tags:u.info.keywords,private:u.info.isPrivate,live:u.info.isLiveContent,duration:1e3*parseInt(u.info.lengthSeconds),duration_raw:e.durationString(e.parseMS(1e3*parseInt(u.info.lengthSeconds)||0)),channel:{name:u.info.author,id:u.info.channelId,url:"https://www.youtube.com"+u.owner.videoOwnerRenderer.title.runs[0].navigationEndpoint.browseEndpoint.canonicalBaseUrl,icon:u.owner.videoOwnerRenderer.thumbnail.thumbnails[0],subscribers:null===(i=null===(n=u.owner.videoOwnerRenderer.subscriberCountText)||void 0===n?void 0:n.simpleText)||void 0===i?void 0:i.replace(" subscribers","")},description:u.info.shortDescription,thumbnail:r(r({},u.info.thumbnail.thumbnails[u.info.thumbnail.thumbnails.length-1]),{id:u.info.videoId}),uploadedAt:u.dateText.simpleText,ratings:{likes:parseInt(u.sentimentBar.sentimentBarRenderer.tooltip.split(" / ")[0].replace(/,/g,"")),dislikes:parseInt(u.sentimentBar.sentimentBarRenderer.tooltip.split(" / ")[1].replace(/,/g,""))},videos:e.getNext(null!=l?l:{})})},e.getNext=function(t,n){var o,l,s,u,d,c,h;void 0===n&&(n=!1);var p=[];if("function"!=typeof t[Symbol.iterator])return p;try{for(var f=i(t),b=f.next();!b.done;b=f.next()){var m=b.value,y=n?m:m.compactVideoRenderer;if(y)try{var v=y.viewCountText.simpleText;v=(/^\d/.test(v)?v:"0").split(" ")[0],p.push(new a.default({id:y.videoId,title:null!==(s=y.title.simpleText)&&void 0!==s?s:null===(u=y.title.runs[0])||void 0===u?void 0:u.text,views:parseInt(v.replace(/,/g,""))||0,duration_raw:null!==(d=y.lengthText.simpleText)&&void 0!==d?d:y.lengthText.accessibility.accessibilityData.label,duration:e.parseDuration(y.lengthText.simpleText)/1e3,channel:{name:y.shortBylineText.runs[0].text,id:y.shortBylineText.runs[0].navigationEndpoint.browseEndpoint.browseId,url:"https://www.youtube.com"+y.shortBylineText.runs[0].navigationEndpoint.browseEndpoint.canonicalBaseUrl,icon:n?y.channelThumbnailSupportedRenderers.channelThumbnailWithLinkRenderer.thumbnail.thumbnails[0]:y.channelThumbnail.thumbnails[0],subscribers:"0",verified:Boolean("Verified"===y.ownerBadges[0].metadataBadgeRenderer.tooltip)},thumbnail:r(r({},y.thumbnail.thumbnails[y.thumbnail.thumbnails.length-1]),{id:y.videoId}),uploadedAt:y.publishedTimeText.simpleText,ratings:{likes:0,dislikes:0},description:null===(h=null===(c=y.descriptionSnippet)||void 0===c?void 0:c.runs[0])||void 0===h?void 0:h.text}))}catch(e){continue}}}catch(e){o={error:e}}finally{try{b&&!b.done&&(l=f.return)&&l.call(f)}finally{if(o)throw o.error}}return p},e.parseHomepage=function(t){var n;try{n=t.split("var ytInitialData = ")[1].split(";<\/script>")[0],n=JSON.parse(n).contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.richGridRenderer.contents}catch(e){return[]}return n&&n.length&&n.find((function(e){return"richItemRenderer"===Object.keys(e)[0]}))?(n=n.filter((function(e){return"richItemRenderer"===Object.keys(e)[0]})).map((function(e){return e.richItemRenderer.content.videoRenderer})),e.getNext(n,!0)):[]},e.getPlaylistURL=function(e){if("string"!=typeof e)return null;var t=d.exec(e);return t?"https://www.youtube.com/playlist?list="+t[0]:null},e.validatePlaylist=function(e){if("string"!=typeof e||null===e.match(d))throw new Error("Invalid playlist url")},e.filter=function(e){switch(e){case"playlist":return"EgIQAw%253D%253D";case"video":return"EgIQAQ%253D%253D";case"channel":return"EgIQAg%253D%253D";default:throw new TypeError('Invalid filter type "'+e+'"!')}},e.parseMS=function(e){var t=e>0?Math.floor:Math.ceil;return{days:t(e/864e5),hours:t(e/36e5)%24,minutes:t(e/6e4)%60,seconds:t(e/1e3)%60}},e.durationString=function(e){var t=Object.keys(e),n=["days","hours","minutes","seconds"],r=t.filter((function(e){return n.includes(e)})).map((function(t){return e[t]>0?e[t]:""})).filter((function(e){return!!e})).map((function(e){return e.toString().padStart(2,"0")})).join(":");return r.length<=3?"0:"+(r.padStart(2,"0")||0):r},e.json=function(e){try{return JSON.parse(e)}catch(e){return null}},e}();t.default=f},496:function(e,t,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function l(e){try{a(r.next(e))}catch(e){o(e)}}function s(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,s)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,r=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(i=(i=l.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){l.label=o[1];break}if(6===o[0]&&l.label<i[1]){l.label=i[1],i=o;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(o);break}i[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},l=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.YouTube=t.Video=t.Playlist=t.Channel=t.Thumbnail=t.Util=void 0;var a=s(n(892));t.Util=a.default;var u=s(n(634));t.Channel=u.default;var d=s(n(354));t.Playlist=d.default;var c=s(n(597));t.Video=c.default;var h=s(n(654));t.Thumbnail=h.default;var p=function(){function e(){throw new Error("The "+this.constructor.name+" class may not be instantiated!")}return e.search=function(e,t){return i(this,void 0,void 0,(function(){var n,i,l,s;return o(this,(function(o){switch(o.label){case 0:if(t||(t={limit:20,type:"video",requestOptions:{}}),!e||"string"!=typeof e)throw new Error('Invalid search query "'+e+'"!');return t.type=t.type||"video",n="all"===t.type?"":"&sp="+a.default.filter(t.type),i="https://youtube.com/results?q="+encodeURIComponent(e.trim()).replace(/%20/g,"+")+"&hl=en"+n,l=t.safeSearch?r(r({},t.requestOptions),{headers:{cookie:"PREF=f2=8000000"}}):{},[4,a.default.getHTML(i,l)];case 1:return s=o.sent(),[2,a.default.parseSearchResult(s,t)]}}))}))},e.searchOne=function(t,n,r,i){return n||(n="video"),new Promise((function(o){e.search(t,{limit:1,type:n,requestOptions:i,safeSearch:Boolean(r)}).then((function(e){if(!e||!e.length)return o(null);o(e[0])})).catch((function(){o(null)}))}))},e.getPlaylist=function(e,t){return i(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:if(t||(t={limit:100,requestOptions:{}}),!e||"string"!=typeof e)throw new Error("Expected playlist url, received "+typeof e+"!");return a.default.validatePlaylist(e),e=a.default.getPlaylistURL(e),[4,a.default.getHTML(e+"&hl=en",t&&t.requestOptions)];case 1:return n=r.sent(),[2,a.default.getPlaylist(n,t&&t.limit)]}}))}))},e.getVideo=function(t,n){return i(this,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:if(!t)throw new Error("Missing video url");if(t instanceof c.default&&(t=t.url),!e.validate(t,"VIDEO"))throw new Error("Invalid video url");return[4,a.default.getHTML(t+"&hl=en",n)];case 1:return r=i.sent(),[2,a.default.getVideo(r)]}}))}))},e.homepage=function(){return i(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return[4,a.default.getHTML("https://www.youtube.com?hl=en")];case 1:return e=t.sent(),[2,a.default.parseHomepage(e)]}}))}))},e.fetchInnerTubeKey=function(){var e,t,n;return i(this,void 0,void 0,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:return[4,a.default.getHTML("https://www.youtube.com?hl=en")];case 1:return r=o.sent(),[2,null!=(i=null!==(t=null===(e=r.split('INNERTUBE_API_KEY":"')[1])||void 0===e?void 0:e.split('"')[0])&&void 0!==t?t:null===(n=r.split('innertubeApiKey":"')[1])||void 0===n?void 0:n.split('"')[0])?i:null]}}))}))},e.trending=function(){var e,t,n,r,s,u,d,h,p,f,b,m,y;return i(this,void 0,void 0,(function(){var i,v,g,w,R,T,x,S,E;return o(this,(function(o){switch(o.label){case 0:return[4,a.default.getHTML("https://www.youtube.com/feed/explore?hl=en")];case 1:i=o.sent();try{v=JSON.parse(i.split("var ytInitialData =")[1].split(";")[0])}catch(e){return[2,null]}if(!(g=null===(b=null===(f=null===(p=null===(h=null===(d=null===(u=null===(s=null===(r=null===(n=null===(t=null===(e=v.contents)||void 0===e?void 0:e.twoColumnBrowseResultsRenderer)||void 0===t?void 0:t.tabs[0].tabRenderer)||void 0===n?void 0:n.content)||void 0===r?void 0:r.sectionListRenderer)||void 0===s?void 0:s.contents[1])||void 0===u?void 0:u.itemSectionRenderer)||void 0===d?void 0:d.contents[0])||void 0===h?void 0:h.shelfRenderer)||void 0===p?void 0:p.content)||void 0===f?void 0:f.expandedShelfContentsRenderer)||void 0===b?void 0:b.items)||!Array.isArray(g))return[2,null];w=[];try{for(R=l(g.map((function(e){return e.videoRenderer}))),T=R.next();!T.done;T=R.next())x=T.value,w.push(new c.default({title:x.title.runs[0].text,id:x.videoId,url:"https://www.youtube.com/watch?v="+x.videoId,description:null===(y=null===(m=x.descriptionSnippet)||void 0===m?void 0:m.runs[0])||void 0===y?void 0:y.text,duration:a.default.parseDuration(x.lengthText.simpleText)/1e3||0,duration_raw:x.lengthText.simpleText,thumbnail:{id:x.videoId,url:x.thumbnail.thumbnails[x.thumbnail.thumbnails.length-1].url,height:x.thumbnail.thumbnails[x.thumbnail.thumbnails.length-1].height,width:x.thumbnail.thumbnails[x.thumbnail.thumbnails.length-1].width},channel:{id:x.ownerText.runs[0].navigationEndpoint.browseEndpoint.browseId,name:x.ownerText.runs[0].text,url:"https://www.youtube.com"+x.ownerText.runs[0].navigationEndpoint.browseEndpoint.canonicalBaseUrl,icon:{url:null,width:0,height:0},verified:!!x.ownerBadges&&Boolean("Verified"===x.ownerBadges[0].metadataBadgeRenderer.tooltip)},uploadedAt:x.publishedTimeText.simpleText,views:x.viewCountText.simpleText.replace(/[^0-9]/g,"")||0}))}catch(e){S={error:e}}finally{try{T&&!T.done&&(E=R.return)&&E.call(R)}finally{if(S)throw S.error}}return[2,w]}}))}))},e.getSuggestions=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:if(!e)throw new Error("Search query was not provided!");return[4,a.default.getHTML("https://clients1.google.com/complete/search?client=youtube&gs_ri=youtube&ds=yt&q="+encodeURIComponent(e))];case 1:return t=r.sent(),n=[],t.split("[").forEach((function(e,t){if(e.split('"')[1]&&1!==t)return n.push(e.split('"')[1])})),n.pop(),[2,n]}}))}))},e.validate=function(t,n){if("string"!=typeof t)return!1;switch(n||(n="PLAYLIST"),n){case"PLAYLIST":return e.Regex.PLAYLIST_URL.test(t);case"PLAYLIST_ID":return e.Regex.PLAYLIST_ID.test(t);case"VIDEO":return e.Regex.VIDEO_URL.test(t);case"VIDEO_ID":return e.Regex.VIDEO_ID.test(t);default:return!1}},e.isPlaylist=function(e){try{return a.default.validatePlaylist(e),!0}catch(e){return!1}},Object.defineProperty(e,"Regex",{get:function(){return{PLAYLIST_URL:a.default.PlaylistURLRegex,PLAYLIST_ID:a.default.PlaylistIDRegex,VIDEO_ID:a.default.VideoIDRegex,VIDEO_URL:a.default.VideoRegex}},enumerable:!1,configurable:!0}),e}();t.YouTube=p,t.default=p},85:(e,t,n)=>{n.r(t),n.d(t,{FetchError:()=>h,Headers:()=>P,Request:()=>q,Response:()=>D,default:()=>G});const r=require("stream"),i=require("http"),o=require("url"),l=require("https"),s=require("zlib"),a=r.Readable,u=Symbol("buffer"),d=Symbol("type");class c{constructor(){this[d]="";const e=arguments[0],t=arguments[1],n=[];let r=0;if(e){const t=e,i=Number(t.length);for(let e=0;e<i;e++){const i=t[e];let o;o=i instanceof Buffer?i:ArrayBuffer.isView(i)?Buffer.from(i.buffer,i.byteOffset,i.byteLength):i instanceof ArrayBuffer?Buffer.from(i):i instanceof c?i[u]:Buffer.from("string"==typeof i?i:String(i)),r+=o.length,n.push(o)}}this[u]=Buffer.concat(n);let i=t&&void 0!==t.type&&String(t.type).toLowerCase();i&&!/[^\u0020-\u007E]/.test(i)&&(this[d]=i)}get size(){return this[u].length}get type(){return this[d]}text(){return Promise.resolve(this[u].toString())}arrayBuffer(){const e=this[u],t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Promise.resolve(t)}stream(){const e=new a;return e._read=function(){},e.push(this[u]),e.push(null),e}toString(){return"[object Blob]"}slice(){const e=this.size,t=arguments[0],n=arguments[1];let r,i;r=void 0===t?0:t<0?Math.max(e+t,0):Math.min(t,e),i=void 0===n?e:n<0?Math.max(e+n,0):Math.min(n,e);const o=Math.max(i-r,0),l=this[u].slice(r,r+o),s=new c([],{type:arguments[2]});return s[u]=l,s}}function h(e,t,n){Error.call(this,e),this.message=e,this.type=t,n&&(this.code=this.errno=n.code),Error.captureStackTrace(this,this.constructor)}let p;Object.defineProperties(c.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(c.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),h.prototype=Object.create(Error.prototype),h.prototype.constructor=h,h.prototype.name="FetchError";try{p=require("encoding").convert}catch(e){}const f=Symbol("Body internals"),b=r.PassThrough;function m(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.size;let o=void 0===i?0:i;var l=n.timeout;let s=void 0===l?0:l;null==e?e=null:v(e)?e=Buffer.from(e.toString()):g(e)||Buffer.isBuffer(e)||("[object ArrayBuffer]"===Object.prototype.toString.call(e)?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof r||(e=Buffer.from(String(e)))),this[f]={body:e,disturbed:!1,error:null},this.size=o,this.timeout=s,e instanceof r&&e.on("error",(function(e){const n="AbortError"===e.name?e:new h(`Invalid response body while trying to fetch ${t.url}: ${e.message}`,"system",e);t[f].error=n}))}function y(){var e=this;if(this[f].disturbed)return m.Promise.reject(new TypeError(`body used already for: ${this.url}`));if(this[f].disturbed=!0,this[f].error)return m.Promise.reject(this[f].error);let t=this.body;if(null===t)return m.Promise.resolve(Buffer.alloc(0));if(g(t)&&(t=t.stream()),Buffer.isBuffer(t))return m.Promise.resolve(t);if(!(t instanceof r))return m.Promise.resolve(Buffer.alloc(0));let n=[],i=0,o=!1;return new m.Promise((function(r,l){let s;e.timeout&&(s=setTimeout((function(){o=!0,l(new h(`Response timeout while trying to fetch ${e.url} (over ${e.timeout}ms)`,"body-timeout"))}),e.timeout)),t.on("error",(function(t){"AbortError"===t.name?(o=!0,l(t)):l(new h(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t))})),t.on("data",(function(t){if(!o&&null!==t){if(e.size&&i+t.length>e.size)return o=!0,void l(new h(`content size at ${e.url} over limit: ${e.size}`,"max-size"));i+=t.length,n.push(t)}})),t.on("end",(function(){if(!o){clearTimeout(s);try{r(Buffer.concat(n,i))}catch(t){l(new h(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t))}}}))}))}function v(e){return"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&("URLSearchParams"===e.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(e)||"function"==typeof e.sort)}function g(e){return"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}function w(e){let t,n,i=e.body;if(e.bodyUsed)throw new Error("cannot clone body after it is used");return i instanceof r&&"function"!=typeof i.getBoundary&&(t=new b,n=new b,i.pipe(t),i.pipe(n),e[f].body=t,i=n),i}function R(e){return null===e?null:"string"==typeof e?"text/plain;charset=UTF-8":v(e)?"application/x-www-form-urlencoded;charset=UTF-8":g(e)?e.type||null:Buffer.isBuffer(e)||"[object ArrayBuffer]"===Object.prototype.toString.call(e)||ArrayBuffer.isView(e)?null:"function"==typeof e.getBoundary?`multipart/form-data;boundary=${e.getBoundary()}`:e instanceof r?null:"text/plain;charset=UTF-8"}function T(e){const t=e.body;return null===t?0:g(t)?t.size:Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync&&(t._lengthRetrievers&&0==t._lengthRetrievers.length||t.hasKnownLength&&t.hasKnownLength())?t.getLengthSync():null}m.prototype={get body(){return this[f].body},get bodyUsed(){return this[f].disturbed},arrayBuffer(){return y.call(this).then((function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}))},blob(){let e=this.headers&&this.headers.get("content-type")||"";return y.call(this).then((function(t){return Object.assign(new c([],{type:e.toLowerCase()}),{[u]:t})}))},json(){var e=this;return y.call(this).then((function(t){try{return JSON.parse(t.toString())}catch(t){return m.Promise.reject(new h(`invalid json response body at ${e.url} reason: ${t.message}`,"invalid-json"))}}))},text(){return y.call(this).then((function(e){return e.toString()}))},buffer(){return y.call(this)},textConverted(){var e=this;return y.call(this).then((function(t){return function(e,t){if("function"!=typeof p)throw new Error("The package `encoding` must be installed to use the textConverted() function");const n=t.get("content-type");let r,i,o="utf-8";return n&&(r=/charset=([^;]*)/i.exec(n)),i=e.slice(0,1024).toString(),!r&&i&&(r=/<meta.+?charset=(['"])(.+?)\1/i.exec(i)),!r&&i&&(r=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(i),r||(r=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(i),r&&r.pop()),r&&(r=/charset=(.*)/i.exec(r.pop()))),!r&&i&&(r=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(i)),r&&(o=r.pop(),"gb2312"!==o&&"gbk"!==o||(o="gb18030")),p(e,"UTF-8",o).toString()}(t,e.headers)}))}},Object.defineProperties(m.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),m.mixIn=function(e){for(const t of Object.getOwnPropertyNames(m.prototype))if(!(t in e)){const n=Object.getOwnPropertyDescriptor(m.prototype,t);Object.defineProperty(e,t,n)}},m.Promise=global.Promise;const x=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,S=/[^\t\x20-\x7e\x80-\xff]/;function E(e){if(e=`${e}`,x.test(e)||""===e)throw new TypeError(`${e} is not a legal HTTP header name`)}function O(e){if(e=`${e}`,S.test(e))throw new TypeError(`${e} is not a legal HTTP header value`)}function _(e,t){t=t.toLowerCase();for(const n in e)if(n.toLowerCase()===t)return n}const I=Symbol("map");class P{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[I]=Object.create(null),e instanceof P){const t=e.raw(),n=Object.keys(t);for(const e of n)for(const n of t[e])this.append(e,n)}else if(null==e);else{if("object"!=typeof e)throw new TypeError("Provided initializer must be an object");{const t=e[Symbol.iterator];if(null!=t){if("function"!=typeof t)throw new TypeError("Header pairs must be iterable");const n=[];for(const t of e){if("object"!=typeof t||"function"!=typeof t[Symbol.iterator])throw new TypeError("Each header pair must be iterable");n.push(Array.from(t))}for(const e of n){if(2!==e.length)throw new TypeError("Each header pair must be a name/value tuple");this.append(e[0],e[1])}}else for(const t of Object.keys(e)){const n=e[t];this.append(t,n)}}}}get(e){E(e=`${e}`);const t=_(this[I],e);return void 0===t?null:this[I][t].join(", ")}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=j(this),r=0;for(;r<n.length;){var i=n[r];const o=i[0],l=i[1];e.call(t,l,o,this),n=j(this),r++}}set(e,t){t=`${t}`,E(e=`${e}`),O(t);const n=_(this[I],e);this[I][void 0!==n?n:e]=[t]}append(e,t){t=`${t}`,E(e=`${e}`),O(t);const n=_(this[I],e);void 0!==n?this[I][n].push(t):this[I][e]=[t]}has(e){return E(e=`${e}`),void 0!==_(this[I],e)}delete(e){E(e=`${e}`);const t=_(this[I],e);void 0!==t&&delete this[I][t]}raw(){return this[I]}keys(){return B(this,"key")}values(){return B(this,"value")}[Symbol.iterator](){return B(this,"key+value")}}function j(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key+value";const n=Object.keys(e[I]).sort();return n.map("key"===t?function(e){return e.toLowerCase()}:"value"===t?function(t){return e[I][t].join(", ")}:function(t){return[t.toLowerCase(),e[I][t].join(", ")]})}P.prototype.entries=P.prototype[Symbol.iterator],Object.defineProperty(P.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(P.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});const L=Symbol("internal");function B(e,t){const n=Object.create(C);return n[L]={target:e,kind:t,index:0},n}const C=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==C)throw new TypeError("Value of `this` is not a HeadersIterator");var e=this[L];const t=e.target,n=e.kind,r=e.index,i=j(t,n);return r>=i.length?{value:void 0,done:!0}:(this[L].index=r+1,{value:i[r],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));function k(e){const t=Object.assign({__proto__:null},e[I]),n=_(e[I],"Host");return void 0!==n&&(t[n]=t[n][0]),t}Object.defineProperty(C,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});const U=Symbol("Response internals"),A=i.STATUS_CODES;class D{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};m.call(this,e,t);const n=t.status||200,r=new P(t.headers);if(null!=e&&!r.has("Content-Type")){const t=R(e);t&&r.append("Content-Type",t)}this[U]={url:t.url,status:n,statusText:t.statusText||A[n],headers:r,counter:t.counter}}get url(){return this[U].url||""}get status(){return this[U].status}get ok(){return this[U].status>=200&&this[U].status<300}get redirected(){return this[U].counter>0}get statusText(){return this[U].statusText}get headers(){return this[U].headers}clone(){return new D(w(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}m.mixIn(D.prototype),Object.defineProperties(D.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(D.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});const M=Symbol("Request internals"),N=o.parse,V=o.format,$="destroy"in r.Readable.prototype;function z(e){return"object"==typeof e&&"object"==typeof e[M]}class q{constructor(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};z(e)?t=N(e.url):(t=e&&e.href?N(e.href):N(`${e}`),e={});let r=n.method||e.method||"GET";if(r=r.toUpperCase(),(null!=n.body||z(e)&&null!==e.body)&&("GET"===r||"HEAD"===r))throw new TypeError("Request with GET/HEAD method cannot have body");let i=null!=n.body?n.body:z(e)&&null!==e.body?w(e):null;m.call(this,i,{timeout:n.timeout||e.timeout||0,size:n.size||e.size||0});const o=new P(n.headers||e.headers||{});if(null!=i&&!o.has("Content-Type")){const e=R(i);e&&o.append("Content-Type",e)}let l=z(e)?e.signal:null;if("signal"in n&&(l=n.signal),null!=l&&!function(e){const t=e&&"object"==typeof e&&Object.getPrototypeOf(e);return!(!t||"AbortSignal"!==t.constructor.name)}(l))throw new TypeError("Expected signal to be an instanceof AbortSignal");this[M]={method:r,redirect:n.redirect||e.redirect||"follow",headers:o,parsedURL:t,signal:l},this.follow=void 0!==n.follow?n.follow:void 0!==e.follow?e.follow:20,this.compress=void 0!==n.compress?n.compress:void 0===e.compress||e.compress,this.counter=n.counter||e.counter||0,this.agent=n.agent||e.agent}get method(){return this[M].method}get url(){return V(this[M].parsedURL)}get headers(){return this[M].headers}get redirect(){return this[M].redirect}get signal(){return this[M].signal}clone(){return new q(this)}}function H(e){Error.call(this,e),this.type="aborted",this.message=e,Error.captureStackTrace(this,this.constructor)}m.mixIn(q.prototype),Object.defineProperty(q.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(q.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),H.prototype=Object.create(Error.prototype),H.prototype.constructor=H,H.prototype.name="AbortError";const J=r.PassThrough,F=o.resolve;function Y(e,t){if(!Y.Promise)throw new Error("native promise missing, set fetch.Promise to your favorite alternative");return m.Promise=Y.Promise,new Y.Promise((function(n,o){const a=new q(e,t),u=function(e){const t=e[M].parsedURL,n=new P(e[M].headers);if(n.has("Accept")||n.set("Accept","*/*"),!t.protocol||!t.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(t.protocol))throw new TypeError("Only HTTP(S) protocols are supported");if(e.signal&&e.body instanceof r.Readable&&!$)throw new Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let i=null;if(null==e.body&&/^(POST|PUT)$/i.test(e.method)&&(i="0"),null!=e.body){const t=T(e);"number"==typeof t&&(i=String(t))}i&&n.set("Content-Length",i),n.has("User-Agent")||n.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),e.compress&&!n.has("Accept-Encoding")&&n.set("Accept-Encoding","gzip,deflate");let o=e.agent;return"function"==typeof o&&(o=o(t)),n.has("Connection")||o||n.set("Connection","close"),Object.assign({},t,{method:e.method,headers:k(n),agent:o})}(a),d=("https:"===u.protocol?l:i).request,c=a.signal;let p=null;const f=function(){let e=new H("The user aborted a request.");o(e),a.body&&a.body instanceof r.Readable&&a.body.destroy(e),p&&p.body&&p.body.emit("error",e)};if(c&&c.aborted)return void f();const b=function(){f(),v()},m=d(u);let y;function v(){m.abort(),c&&c.removeEventListener("abort",b),clearTimeout(y)}c&&c.addEventListener("abort",b),a.timeout&&m.once("socket",(function(e){y=setTimeout((function(){o(new h(`network timeout at: ${a.url}`,"request-timeout")),v()}),a.timeout)})),m.on("error",(function(e){o(new h(`request to ${a.url} failed, reason: ${e.message}`,"system",e)),v()})),m.on("response",(function(e){clearTimeout(y);const t=function(e){const t=new P;for(const n of Object.keys(e))if(!x.test(n))if(Array.isArray(e[n]))for(const r of e[n])S.test(r)||(void 0===t[I][n]?t[I][n]=[r]:t[I][n].push(r));else S.test(e[n])||(t[I][n]=[e[n]]);return t}(e.headers);if(Y.isRedirect(e.statusCode)){const r=t.get("Location"),i=null===r?null:F(a.url,r);switch(a.redirect){case"error":return o(new h(`uri requested responds with a redirect, redirect mode is set to error: ${a.url}`,"no-redirect")),void v();case"manual":if(null!==i)try{t.set("Location",i)}catch(e){o(e)}break;case"follow":if(null===i)break;if(a.counter>=a.follow)return o(new h(`maximum redirect reached at: ${a.url}`,"max-redirect")),void v();const r={headers:new P(a.headers),follow:a.follow,counter:a.counter+1,agent:a.agent,compress:a.compress,method:a.method,body:a.body,signal:a.signal,timeout:a.timeout,size:a.size};return 303!==e.statusCode&&a.body&&null===T(a)?(o(new h("Cannot follow redirect with body being a readable stream","unsupported-redirect")),void v()):(303!==e.statusCode&&(301!==e.statusCode&&302!==e.statusCode||"POST"!==a.method)||(r.method="GET",r.body=void 0,r.headers.delete("content-length")),n(Y(new q(i,r))),void v())}}e.once("end",(function(){c&&c.removeEventListener("abort",b)}));let r=e.pipe(new J);const i={url:a.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:a.size,timeout:a.timeout,counter:a.counter},l=t.get("Content-Encoding");if(!a.compress||"HEAD"===a.method||null===l||204===e.statusCode||304===e.statusCode)return p=new D(r,i),void n(p);const u={flush:s.Z_SYNC_FLUSH,finishFlush:s.Z_SYNC_FLUSH};if("gzip"==l||"x-gzip"==l)return r=r.pipe(s.createGunzip(u)),p=new D(r,i),void n(p);if("deflate"!=l&&"x-deflate"!=l){if("br"==l&&"function"==typeof s.createBrotliDecompress)return r=r.pipe(s.createBrotliDecompress()),p=new D(r,i),void n(p);p=new D(r,i),n(p)}else e.pipe(new J).once("data",(function(e){r=8==(15&e[0])?r.pipe(s.createInflate()):r.pipe(s.createInflateRaw()),p=new D(r,i),n(p)}))})),function(e,t){const n=t.body;null===n?e.end():g(n)?n.stream().pipe(e):Buffer.isBuffer(n)?(e.write(n),e.end()):n.pipe(e)}(m,a)}))}Y.isRedirect=function(e){return 301===e||302===e||303===e||307===e||308===e},Y.Promise=global.Promise;const G=Y}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}return n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(496)})()}));